---
# yaml-language-server: $schema=https://json.schemastore.org/kustomization
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ./certificate.yaml
  - ./external.yaml
  - ./internal.yaml
  - ./redirect.yaml
  - ./pushsecret.yaml
replacements:
  - source:
      kind: Secret
      name: cluster-secrets
      fieldPath: data.SECRET_DOMAIN
    targets:
      - select:
          kind: Gateway
        fieldPaths:
          - spec.listeners.[name=http].hostname
          - spec.listeners.[name=https].hostname
      - select:
          kind: PushSecret
        fieldPaths:
          - metadata.name
          - spec.selector.secret.name